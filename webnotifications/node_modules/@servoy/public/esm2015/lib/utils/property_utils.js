const scrollbarConstants = {
    SCROLLBARS_WHEN_NEEDED: 0,
    VERTICAL_SCROLLBAR_AS_NEEDED: 1,
    VERTICAL_SCROLLBAR_ALWAYS: 2,
    VERTICAL_SCROLLBAR_NEVER: 4,
    HORIZONTAL_SCROLLBAR_AS_NEEDED: 8,
    HORIZONTAL_SCROLLBAR_ALWAYS: 16,
    HORIZONTAL_SCROLLBAR_NEVER: 32
};
export class PropertyUtils {
    static setHorizontalAlignment(element, renderer, halign) {
        if (halign !== -1) {
            if (halign === 0) {
                renderer.setStyle(element, 'text-align', 'center');
            }
            else if (halign === 4) {
                renderer.setStyle(element, 'text-align', 'right');
            }
            else {
                renderer.setStyle(element, 'text-align', 'left');
            }
        }
    }
    static setRotation(element, renderer, rotation, size) {
        const r = 'rotate(' + rotation + 'deg)';
        renderer.setStyle(element, '-moz-transform', r);
        renderer.setStyle(element, '-webkit-transform', r);
        renderer.setStyle(element, '-o-transform', r);
        renderer.setStyle(element, '-ms-transform', r);
        renderer.setStyle(element, 'transform', r);
        renderer.setStyle(element, 'position', 'absolute');
        if (rotation === 90 || rotation === 270) {
            renderer.setStyle(element, 'width', size.height + 'px');
            renderer.setStyle(element, 'height', size.width + 'px');
            renderer.setStyle(element, 'left', (size.width - size.height) / 2 + 'px');
            renderer.setStyle(element, 'top', (size.height - size.width) / 2 + 'px');
        }
    }
    static setBorder(element, renderer, newVal) {
        if (typeof newVal !== 'object' || newVal == null) {
            renderer.removeStyle(element, 'border');
            return;
        }
        if (renderer.parentNode(element).nodeName === 'FIELDSET') {
            // unwrap fieldset
            const parent = renderer.parentNode(element);
            renderer.insertBefore(renderer.parentNode(parent), element, parent);
            renderer.removeChild(renderer.parentNode(parent), parent);
        }
        if (newVal.type === 'TitledBorder') {
            const fieldset = renderer.createElement('fieldset');
            renderer.setAttribute(fieldset, 'style', 'padding:1px;margin:0px;border:1px solid silver;width:100%;height:100%');
            const legend = renderer.createElement('legend');
            renderer.setAttribute(legend, 'style', 'border-bottom:0px; margin:0px;width:auto;color:' + newVal.color + ';text-align:' + newVal.titleJustification);
            if (newVal.font) {
                for (const key of Object.keys(newVal.font)) {
                    // keys like 'fontSize' need to be converted into 'font-size'
                    renderer.setStyle(legend, key.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase(), newVal.font[key]);
                }
            }
            renderer.appendChild(legend, renderer.createText(newVal.title));
            // this is the way it is done in the old ngclient, but the actual component is positioned partially outside the border
            //            var parent = renderer.parentNode(element);
            //            renderer.insertBefore(parent, fieldset, element);
            //            renderer.appendChild(fieldset, legend);
            //            renderer.appendChild(fieldset, element);
            renderer.appendChild(fieldset, legend);
            for (const i in element.childNodes) {
                if (element.childNodes[i].nodeType === 1) {
                    renderer.appendChild(fieldset, element.childNodes[i]);
                }
            }
            renderer.appendChild(element, fieldset);
        }
        else if (newVal.borderStyle) {
            renderer.removeStyle(element, 'border');
            for (const key of Object.keys(newVal.borderStyle)) {
                renderer.setStyle(element, key.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase(), newVal.borderStyle[key]);
            }
        }
    }
    static setFont(element, renderer, newVal) {
        if (typeof newVal !== 'object' || newVal == null) {
            renderer.removeStyle(element, 'font');
            return;
        }
        renderer.removeStyle(element, 'font');
        for (const key of Object.keys(newVal)) {
            renderer.setStyle(element, key, newVal[key]);
        }
    }
    static setVisible(element, renderer, newVal) {
        let correctElement = element;
        if (renderer.parentNode(renderer.parentNode(element)) === element.closest('.svy-wrapper')) {
            correctElement = renderer.parentNode(renderer.parentNode(element));
        }
        if (newVal === true) {
            // can we improve this ?
            renderer.removeStyle(correctElement, 'display');
        }
        else if (newVal === false) {
            renderer.setStyle(correctElement, 'display', 'none');
        }
    }
    static addSelectOnEnter(element, renderer, doc) {
        renderer.listen(element, 'focus', () => {
            setTimeout(() => {
                // this access "document" directly which shoudn't really be done, but angular doesn't have encapsuled support for testing "is(":focus")"
                const currentFocusedElement = doc.querySelector(':focus');
                if (currentFocusedElement === element)
                    element.select();
            }, 0);
        });
    }
    static getScrollbarsStyleObj(scrollbars) {
        const style = {};
        /* eslint-disable no-bitwise */
        if ((scrollbars & scrollbarConstants.HORIZONTAL_SCROLLBAR_NEVER) === scrollbarConstants.HORIZONTAL_SCROLLBAR_NEVER) {
            style['overflowX'] = 'hidden';
        }
        else if ((scrollbars & scrollbarConstants.HORIZONTAL_SCROLLBAR_ALWAYS) === scrollbarConstants.HORIZONTAL_SCROLLBAR_ALWAYS) {
            style['overflowX'] = 'scroll';
        }
        else {
            style['overflowX'] = 'auto';
        }
        if ((scrollbars & scrollbarConstants.VERTICAL_SCROLLBAR_NEVER) === scrollbarConstants.VERTICAL_SCROLLBAR_NEVER) {
            style['overflowY'] = 'hidden';
        }
        else if ((scrollbars & scrollbarConstants.VERTICAL_SCROLLBAR_ALWAYS) === scrollbarConstants.VERTICAL_SCROLLBAR_ALWAYS) {
            style['overflowY'] = 'scroll'; // $NON-NLS-1$
        }
        else {
            style['overflowY'] = 'auto'; // $NON-NLS-1$
        }
        /* eslint-enable no-bitwise */
        return style;
    }
    static setScrollbars(element, renderer, value) {
        const style = this.getScrollbarsStyleObj(value);
        Object.keys(style).forEach(key => {
            renderer.setStyle(element, key, style[key]);
        });
    }
    // internal function
    static getPropByStringPath(o, s) {
        s = s.replace(/\[(\w+)\]/g, '.$1'); // convert indexes to properties
        s = s.replace(/^\./, ''); // strip a leading dot
        const a = s.split('.');
        while (a.length) {
            const n = a.shift();
            if (n in o) {
                o = o[n];
            }
            else {
                return;
            }
            return o;
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvcGVydHlfdXRpbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9zZXJ2b3ktcHVibGljL3NyYy9saWIvdXRpbHMvcHJvcGVydHlfdXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUEsTUFBTSxrQkFBa0IsR0FBRztJQUNuQixzQkFBc0IsRUFBRSxDQUFDO0lBQ3pCLDRCQUE0QixFQUFFLENBQUM7SUFDL0IseUJBQXlCLEVBQUUsQ0FBQztJQUM1Qix3QkFBd0IsRUFBRSxDQUFDO0lBQzNCLDhCQUE4QixFQUFFLENBQUM7SUFDakMsMkJBQTJCLEVBQUUsRUFBRTtJQUMvQiwwQkFBMEIsRUFBRSxFQUFFO0NBQ3JDLENBQUM7QUFDRixNQUFNLE9BQU8sYUFBYTtJQUVmLE1BQU0sQ0FBQyxzQkFBc0IsQ0FBRSxPQUFZLEVBQUUsUUFBbUIsRUFBRSxNQUFNO1FBQzNFLElBQUssTUFBTSxLQUFLLENBQUMsQ0FBQyxFQUFHO1lBQ2pCLElBQUssTUFBTSxLQUFLLENBQUMsRUFBRztnQkFDaEIsUUFBUSxDQUFDLFFBQVEsQ0FBRSxPQUFPLEVBQUUsWUFBWSxFQUFFLFFBQVEsQ0FBRSxDQUFDO2FBQ3hEO2lCQUFNLElBQUssTUFBTSxLQUFLLENBQUMsRUFBRztnQkFDdkIsUUFBUSxDQUFDLFFBQVEsQ0FBRSxPQUFPLEVBQUUsWUFBWSxFQUFFLE9BQU8sQ0FBRSxDQUFDO2FBQ3ZEO2lCQUFNO2dCQUNILFFBQVEsQ0FBQyxRQUFRLENBQUUsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLENBQUUsQ0FBQzthQUN0RDtTQUNKO0lBQ0wsQ0FBQztJQUVNLE1BQU0sQ0FBQyxXQUFXLENBQUMsT0FBb0IsRUFBRSxRQUFtQixFQUFFLFFBQWdCLEVBQUUsSUFBcUM7UUFDeEgsTUFBTSxDQUFDLEdBQUcsU0FBUyxHQUFHLFFBQVEsR0FBRyxNQUFNLENBQUM7UUFDeEMsUUFBUSxDQUFDLFFBQVEsQ0FBRSxPQUFPLEVBQUUsZ0JBQWdCLEVBQUcsQ0FBQyxDQUFFLENBQUM7UUFDbkQsUUFBUSxDQUFDLFFBQVEsQ0FBRSxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsQ0FBQyxDQUFFLENBQUM7UUFDckQsUUFBUSxDQUFDLFFBQVEsQ0FBRSxPQUFPLEVBQUUsY0FBYyxFQUFFLENBQUMsQ0FBRSxDQUFDO1FBQ2hELFFBQVEsQ0FBQyxRQUFRLENBQUUsT0FBTyxFQUFFLGVBQWUsRUFBRSxDQUFDLENBQUUsQ0FBQztRQUNqRCxRQUFRLENBQUMsUUFBUSxDQUFFLE9BQU8sRUFBRSxXQUFXLEVBQUUsQ0FBQyxDQUFFLENBQUM7UUFDN0MsUUFBUSxDQUFDLFFBQVEsQ0FBRSxPQUFPLEVBQUUsVUFBVSxFQUFFLFVBQVUsQ0FBRSxDQUFDO1FBQ3JELElBQUksUUFBUSxLQUFLLEVBQUUsSUFBSSxRQUFRLEtBQUssR0FBRyxFQUFFO1lBQ3JDLFFBQVEsQ0FBQyxRQUFRLENBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBRSxDQUFDO1lBQzFELFFBQVEsQ0FBQyxRQUFRLENBQUUsT0FBTyxFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBRSxDQUFDO1lBQzFELFFBQVEsQ0FBQyxRQUFRLENBQUUsT0FBTyxFQUFFLE1BQU0sRUFBRSxDQUFDLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUUsQ0FBQztZQUM1RSxRQUFRLENBQUMsUUFBUSxDQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUUsQ0FBQyxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFFLENBQUM7U0FDOUU7SUFDTCxDQUFDO0lBRU0sTUFBTSxDQUFDLFNBQVMsQ0FBRSxPQUFZLEVBQUUsUUFBbUIsRUFBRSxNQUFNO1FBQzlELElBQUssT0FBTyxNQUFNLEtBQUssUUFBUSxJQUFJLE1BQU0sSUFBSSxJQUFJLEVBQUc7WUFDbkQsUUFBUSxDQUFDLFdBQVcsQ0FBRSxPQUFPLEVBQUUsUUFBUSxDQUFFLENBQUM7WUFBQyxPQUFPO1NBQ2xEO1FBRUQsSUFBSyxRQUFRLENBQUMsVUFBVSxDQUFFLE9BQU8sQ0FBRSxDQUFDLFFBQVEsS0FBSyxVQUFVLEVBQUc7WUFDMUQsa0JBQWtCO1lBQ2xCLE1BQU0sTUFBTSxHQUFHLFFBQVEsQ0FBQyxVQUFVLENBQUUsT0FBTyxDQUFFLENBQUM7WUFDOUMsUUFBUSxDQUFDLFlBQVksQ0FBRSxRQUFRLENBQUMsVUFBVSxDQUFFLE1BQU0sQ0FBRSxFQUFFLE9BQU8sRUFBRSxNQUFNLENBQUUsQ0FBQztZQUN4RSxRQUFRLENBQUMsV0FBVyxDQUFFLFFBQVEsQ0FBQyxVQUFVLENBQUUsTUFBTSxDQUFFLEVBQUUsTUFBTSxDQUFFLENBQUM7U0FDakU7UUFDRCxJQUFLLE1BQU0sQ0FBQyxJQUFJLEtBQUssY0FBYyxFQUFHO1lBQ2xDLE1BQU0sUUFBUSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUUsVUFBVSxDQUFFLENBQUM7WUFDdEQsUUFBUSxDQUFDLFlBQVksQ0FBRSxRQUFRLEVBQUUsT0FBTyxFQUFFLHVFQUF1RSxDQUFFLENBQUM7WUFFcEgsTUFBTSxNQUFNLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBRSxRQUFRLENBQUUsQ0FBQztZQUNsRCxRQUFRLENBQUMsWUFBWSxDQUFFLE1BQU0sRUFBRSxPQUFPLEVBQUUsaURBQWlELEdBQUcsTUFBTSxDQUFDLEtBQUssR0FBRyxjQUFjLEdBQUcsTUFBTSxDQUFDLGtCQUFrQixDQUFFLENBQUM7WUFDeEosSUFBSyxNQUFNLENBQUMsSUFBSSxFQUFHO2dCQUNmLEtBQU0sTUFBTSxHQUFHLElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUc7b0JBQzFDLDZEQUE2RDtvQkFDN0QsUUFBUSxDQUFDLFFBQVEsQ0FBRSxNQUFNLEVBQUUsR0FBRyxDQUFDLE9BQU8sQ0FBRSxpQkFBaUIsRUFBRSxPQUFPLENBQUUsQ0FBQyxXQUFXLEVBQUUsRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFFLENBQUM7aUJBQzFHO2FBQ0o7WUFDRCxRQUFRLENBQUMsV0FBVyxDQUFFLE1BQU0sRUFBRSxRQUFRLENBQUMsVUFBVSxDQUFFLE1BQU0sQ0FBQyxLQUFLLENBQUUsQ0FBRSxDQUFDO1lBRXBFLHNIQUFzSDtZQUN0SCx3REFBd0Q7WUFDeEQsK0RBQStEO1lBQy9ELHFEQUFxRDtZQUNyRCxzREFBc0Q7WUFFdEQsUUFBUSxDQUFDLFdBQVcsQ0FBRSxRQUFRLEVBQUUsTUFBTSxDQUFFLENBQUM7WUFDekMsS0FBTSxNQUFNLENBQUMsSUFBSSxPQUFPLENBQUMsVUFBVSxFQUFHO2dCQUNsQyxJQUFLLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxLQUFLLENBQUMsRUFBRztvQkFDeEMsUUFBUSxDQUFDLFdBQVcsQ0FBRSxRQUFRLEVBQUUsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBRSxDQUFDO2lCQUMzRDthQUNKO1lBQ0QsUUFBUSxDQUFDLFdBQVcsQ0FBRSxPQUFPLEVBQUUsUUFBUSxDQUFFLENBQUM7U0FFN0M7YUFBTSxJQUFLLE1BQU0sQ0FBQyxXQUFXLEVBQUc7WUFDN0IsUUFBUSxDQUFDLFdBQVcsQ0FBRSxPQUFPLEVBQUUsUUFBUSxDQUFFLENBQUM7WUFDMUMsS0FBTSxNQUFNLEdBQUcsSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsRUFBRztnQkFDakQsUUFBUSxDQUFDLFFBQVEsQ0FBRSxPQUFPLEVBQUUsR0FBRyxDQUFDLE9BQU8sQ0FBRSxpQkFBaUIsRUFBRSxPQUFPLENBQUUsQ0FBQyxXQUFXLEVBQUUsRUFBRSxNQUFNLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFFLENBQUM7YUFDbEg7U0FDSjtJQUNMLENBQUM7SUFFTSxNQUFNLENBQUMsT0FBTyxDQUFFLE9BQVksRUFBRSxRQUFtQixFQUFFLE1BQU07UUFDNUQsSUFBSyxPQUFPLE1BQU0sS0FBSyxRQUFRLElBQUksTUFBTSxJQUFJLElBQUksRUFBRztZQUMzRCxRQUFRLENBQUMsV0FBVyxDQUFFLE9BQU8sRUFBRSxNQUFNLENBQUUsQ0FBQztZQUFDLE9BQU87U0FDaEQ7UUFFTyxRQUFRLENBQUMsV0FBVyxDQUFFLE9BQU8sRUFBRSxNQUFNLENBQUUsQ0FBQztRQUN4QyxLQUFNLE1BQU0sR0FBRyxJQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUUsTUFBTSxDQUFDLEVBQUc7WUFDdEMsUUFBUSxDQUFDLFFBQVEsQ0FBRSxPQUFPLEVBQUUsR0FBRyxFQUFHLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBRSxDQUFDO1NBQ25EO0lBQ0wsQ0FBQztJQUVNLE1BQU0sQ0FBQyxVQUFVLENBQUUsT0FBWSxFQUFFLFFBQW1CLEVBQUUsTUFBTTtRQUMvRCxJQUFJLGNBQWMsR0FBRyxPQUFPLENBQUM7UUFDN0IsSUFBSSxRQUFRLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUMsS0FBSyxPQUFPLENBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxFQUFFO1lBQ3ZGLGNBQWMsR0FBRyxRQUFRLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztTQUN0RTtRQUNELElBQUssTUFBTSxLQUFLLElBQUksRUFBRztZQUNuQix3QkFBd0I7WUFDeEIsUUFBUSxDQUFDLFdBQVcsQ0FBRSxjQUFjLEVBQUUsU0FBUyxDQUFFLENBQUM7U0FDckQ7YUFBTSxJQUFJLE1BQU0sS0FBSyxLQUFLLEVBQUU7WUFDekIsUUFBUSxDQUFDLFFBQVEsQ0FBRSxjQUFjLEVBQUUsU0FBUyxFQUFHLE1BQU0sQ0FBRSxDQUFDO1NBQzNEO0lBQ0wsQ0FBQztJQUVNLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBRSxPQUFZLEVBQUUsUUFBbUIsRUFBRSxHQUFhO1FBQzVFLFFBQVEsQ0FBQyxNQUFNLENBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxHQUFHLEVBQUU7WUFDcEMsVUFBVSxDQUFDLEdBQUcsRUFBRTtnQkFDWix3SUFBd0k7Z0JBQ3hJLE1BQU0scUJBQXFCLEdBQUcsR0FBRyxDQUFDLGFBQWEsQ0FBRSxRQUFRLENBQUUsQ0FBQztnQkFDNUQsSUFBSyxxQkFBcUIsS0FBSyxPQUFPO29CQUNsQyxPQUFPLENBQUMsTUFBTSxFQUFFLENBQUM7WUFDekIsQ0FBQyxFQUFFLENBQUMsQ0FBRSxDQUFDO1FBQ1gsQ0FBQyxDQUFFLENBQUM7SUFDUixDQUFDO0lBQ00sTUFBTSxDQUFDLHFCQUFxQixDQUFDLFVBQWtCO1FBQ25ELE1BQU0sS0FBSyxHQUFHLEVBQUUsQ0FBQztRQUNqQiwrQkFBK0I7UUFDL0IsSUFBSSxDQUFDLFVBQVUsR0FBRyxrQkFBa0IsQ0FBQywwQkFBMEIsQ0FBQyxLQUFLLGtCQUFrQixDQUFDLDBCQUEwQixFQUFFO1lBQ2xILEtBQUssQ0FBQyxXQUFXLENBQUMsR0FBRyxRQUFRLENBQUM7U0FDL0I7YUFBTSxJQUFJLENBQUMsVUFBVSxHQUFHLGtCQUFrQixDQUFDLDJCQUEyQixDQUFDLEtBQUssa0JBQWtCLENBQUMsMkJBQTJCLEVBQUU7WUFDM0gsS0FBSyxDQUFDLFdBQVcsQ0FBQyxHQUFHLFFBQVEsQ0FBQztTQUMvQjthQUFNO1lBQ0wsS0FBSyxDQUFDLFdBQVcsQ0FBQyxHQUFHLE1BQU0sQ0FBQztTQUM3QjtRQUVELElBQUksQ0FBQyxVQUFVLEdBQUcsa0JBQWtCLENBQUMsd0JBQXdCLENBQUMsS0FBSyxrQkFBa0IsQ0FBQyx3QkFBd0IsRUFBRTtZQUM5RyxLQUFLLENBQUMsV0FBVyxDQUFDLEdBQUcsUUFBUSxDQUFDO1NBQy9CO2FBQU0sSUFBSSxDQUFDLFVBQVUsR0FBRyxrQkFBa0IsQ0FBQyx5QkFBeUIsQ0FBQyxLQUFLLGtCQUFrQixDQUFDLHlCQUF5QixFQUFFO1lBQ3ZILEtBQUssQ0FBQyxXQUFXLENBQUMsR0FBRyxRQUFRLENBQUMsQ0FBQyxjQUFjO1NBQzlDO2FBQU07WUFDTCxLQUFLLENBQUMsV0FBVyxDQUFDLEdBQUcsTUFBTSxDQUFDLENBQUMsY0FBYztTQUM1QztRQUNELDhCQUE4QjtRQUM5QixPQUFPLEtBQUssQ0FBQztJQUNmLENBQUM7SUFFTSxNQUFNLENBQUMsYUFBYSxDQUFDLE9BQVksRUFBRSxRQUFtQixFQUFFLEtBQUs7UUFDbEUsTUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDLHFCQUFxQixDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ2hELE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxFQUFFO1lBQ2hDLFFBQVEsQ0FBQyxRQUFRLENBQUMsT0FBTyxFQUFFLEdBQUcsRUFBRSxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUM3QyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFDRCxvQkFBb0I7SUFDYixNQUFNLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxFQUFFLENBQUM7UUFDcEMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsWUFBWSxFQUFFLEtBQUssQ0FBQyxDQUFDLENBQUMsZ0NBQWdDO1FBQ3BFLENBQUMsR0FBRyxDQUFDLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFXLHNCQUFzQjtRQUMxRCxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3ZCLE9BQU8sQ0FBQyxDQUFDLE1BQU0sRUFBRTtZQUNmLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQztZQUNwQixJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUU7Z0JBQ1YsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQzthQUNWO2lCQUFNO2dCQUNMLE9BQU87YUFDUjtZQUNELE9BQU8sQ0FBQyxDQUFDO1NBQ1Y7SUFDSCxDQUFDO0NBQ0wiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSZW5kZXJlcjIgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuXHJcbmNvbnN0IHNjcm9sbGJhckNvbnN0YW50cyA9IHtcclxuICAgICAgICBTQ1JPTExCQVJTX1dIRU5fTkVFREVEOiAwLFxyXG4gICAgICAgIFZFUlRJQ0FMX1NDUk9MTEJBUl9BU19ORUVERUQ6IDEsXHJcbiAgICAgICAgVkVSVElDQUxfU0NST0xMQkFSX0FMV0FZUzogMixcclxuICAgICAgICBWRVJUSUNBTF9TQ1JPTExCQVJfTkVWRVI6IDQsXHJcbiAgICAgICAgSE9SSVpPTlRBTF9TQ1JPTExCQVJfQVNfTkVFREVEOiA4LFxyXG4gICAgICAgIEhPUklaT05UQUxfU0NST0xMQkFSX0FMV0FZUzogMTYsXHJcbiAgICAgICAgSE9SSVpPTlRBTF9TQ1JPTExCQVJfTkVWRVI6IDMyXHJcbn07XHJcbmV4cG9ydCBjbGFzcyBQcm9wZXJ0eVV0aWxzIHtcclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIHNldEhvcml6b250YWxBbGlnbm1lbnQoIGVsZW1lbnQ6IGFueSwgcmVuZGVyZXI6IFJlbmRlcmVyMiwgaGFsaWduICkge1xyXG4gICAgICAgIGlmICggaGFsaWduICE9PSAtMSApIHtcclxuICAgICAgICAgICAgaWYgKCBoYWxpZ24gPT09IDAgKSB7XHJcbiAgICAgICAgICAgICAgICByZW5kZXJlci5zZXRTdHlsZSggZWxlbWVudCwgJ3RleHQtYWxpZ24nLCAnY2VudGVyJyApO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCBoYWxpZ24gPT09IDQgKSB7XHJcbiAgICAgICAgICAgICAgICByZW5kZXJlci5zZXRTdHlsZSggZWxlbWVudCwgJ3RleHQtYWxpZ24nLCAncmlnaHQnICk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZW5kZXJlci5zZXRTdHlsZSggZWxlbWVudCwgJ3RleHQtYWxpZ24nLCAnbGVmdCcgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIHNldFJvdGF0aW9uKGVsZW1lbnQ6IEhUTUxFbGVtZW50LCByZW5kZXJlcjogUmVuZGVyZXIyLCByb3RhdGlvbjogbnVtYmVyLCBzaXplOiB7d2lkdGg6IG51bWJlcjsgaGVpZ2h0OiBudW1iZXJ9KSB7XHJcbiAgICAgICAgY29uc3QgciA9ICdyb3RhdGUoJyArIHJvdGF0aW9uICsgJ2RlZyknO1xyXG4gICAgICAgIHJlbmRlcmVyLnNldFN0eWxlKCBlbGVtZW50LCAnLW1vei10cmFuc2Zvcm0nLCAgciApO1xyXG4gICAgICAgIHJlbmRlcmVyLnNldFN0eWxlKCBlbGVtZW50LCAnLXdlYmtpdC10cmFuc2Zvcm0nLCByICk7XHJcbiAgICAgICAgcmVuZGVyZXIuc2V0U3R5bGUoIGVsZW1lbnQsICctby10cmFuc2Zvcm0nLCByICk7XHJcbiAgICAgICAgcmVuZGVyZXIuc2V0U3R5bGUoIGVsZW1lbnQsICctbXMtdHJhbnNmb3JtJywgciApO1xyXG4gICAgICAgIHJlbmRlcmVyLnNldFN0eWxlKCBlbGVtZW50LCAndHJhbnNmb3JtJywgciApO1xyXG4gICAgICAgIHJlbmRlcmVyLnNldFN0eWxlKCBlbGVtZW50LCAncG9zaXRpb24nLCAnYWJzb2x1dGUnICk7XHJcbiAgICAgICAgaWYgKHJvdGF0aW9uID09PSA5MCB8fCByb3RhdGlvbiA9PT0gMjcwKSB7XHJcbiAgICAgICAgICAgIHJlbmRlcmVyLnNldFN0eWxlKCBlbGVtZW50LCAnd2lkdGgnLCBzaXplLmhlaWdodCArICdweCcgKTtcclxuICAgICAgICAgICAgcmVuZGVyZXIuc2V0U3R5bGUoIGVsZW1lbnQsICdoZWlnaHQnLCBzaXplLndpZHRoICsgJ3B4JyApO1xyXG4gICAgICAgICAgICByZW5kZXJlci5zZXRTdHlsZSggZWxlbWVudCwgJ2xlZnQnLCAoc2l6ZS53aWR0aCAtIHNpemUuaGVpZ2h0KSAvIDIgKyAncHgnICk7XHJcbiAgICAgICAgICAgIHJlbmRlcmVyLnNldFN0eWxlKCBlbGVtZW50LCAndG9wJywgKHNpemUuaGVpZ2h0IC0gc2l6ZS53aWR0aCkgLyAyICsgJ3B4JyApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIHNldEJvcmRlciggZWxlbWVudDogYW55LCByZW5kZXJlcjogUmVuZGVyZXIyLCBuZXdWYWwgKSB7XHJcbiAgICAgICAgaWYgKCB0eXBlb2YgbmV3VmFsICE9PSAnb2JqZWN0JyB8fCBuZXdWYWwgPT0gbnVsbCApIHtcbiAgICAgICAgIHJlbmRlcmVyLnJlbW92ZVN0eWxlKCBlbGVtZW50LCAnYm9yZGVyJyApOyByZXR1cm47XG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCByZW5kZXJlci5wYXJlbnROb2RlKCBlbGVtZW50ICkubm9kZU5hbWUgPT09ICdGSUVMRFNFVCcgKSB7XHJcbiAgICAgICAgICAgIC8vIHVud3JhcCBmaWVsZHNldFxyXG4gICAgICAgICAgICBjb25zdCBwYXJlbnQgPSByZW5kZXJlci5wYXJlbnROb2RlKCBlbGVtZW50ICk7XHJcbiAgICAgICAgICAgIHJlbmRlcmVyLmluc2VydEJlZm9yZSggcmVuZGVyZXIucGFyZW50Tm9kZSggcGFyZW50ICksIGVsZW1lbnQsIHBhcmVudCApO1xyXG4gICAgICAgICAgICByZW5kZXJlci5yZW1vdmVDaGlsZCggcmVuZGVyZXIucGFyZW50Tm9kZSggcGFyZW50ICksIHBhcmVudCApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIG5ld1ZhbC50eXBlID09PSAnVGl0bGVkQm9yZGVyJyApIHtcclxuICAgICAgICAgICAgY29uc3QgZmllbGRzZXQgPSByZW5kZXJlci5jcmVhdGVFbGVtZW50KCAnZmllbGRzZXQnICk7XHJcbiAgICAgICAgICAgIHJlbmRlcmVyLnNldEF0dHJpYnV0ZSggZmllbGRzZXQsICdzdHlsZScsICdwYWRkaW5nOjFweDttYXJnaW46MHB4O2JvcmRlcjoxcHggc29saWQgc2lsdmVyO3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCUnICk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBsZWdlbmQgPSByZW5kZXJlci5jcmVhdGVFbGVtZW50KCAnbGVnZW5kJyApO1xyXG4gICAgICAgICAgICByZW5kZXJlci5zZXRBdHRyaWJ1dGUoIGxlZ2VuZCwgJ3N0eWxlJywgJ2JvcmRlci1ib3R0b206MHB4OyBtYXJnaW46MHB4O3dpZHRoOmF1dG87Y29sb3I6JyArIG5ld1ZhbC5jb2xvciArICc7dGV4dC1hbGlnbjonICsgbmV3VmFsLnRpdGxlSnVzdGlmaWNhdGlvbiApO1xyXG4gICAgICAgICAgICBpZiAoIG5ld1ZhbC5mb250ICkge1xyXG4gICAgICAgICAgICAgICAgZm9yICggY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKG5ld1ZhbC5mb250KSApIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBrZXlzIGxpa2UgJ2ZvbnRTaXplJyBuZWVkIHRvIGJlIGNvbnZlcnRlZCBpbnRvICdmb250LXNpemUnXHJcbiAgICAgICAgICAgICAgICAgICAgcmVuZGVyZXIuc2V0U3R5bGUoIGxlZ2VuZCwga2V5LnJlcGxhY2UoIC8oW2Etel0pKFtBLVpdKS9nLCAnJDEtJDInICkudG9Mb3dlckNhc2UoKSwgbmV3VmFsLmZvbnRba2V5XSApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJlbmRlcmVyLmFwcGVuZENoaWxkKCBsZWdlbmQsIHJlbmRlcmVyLmNyZWF0ZVRleHQoIG5ld1ZhbC50aXRsZSApICk7XHJcblxyXG4gICAgICAgICAgICAvLyB0aGlzIGlzIHRoZSB3YXkgaXQgaXMgZG9uZSBpbiB0aGUgb2xkIG5nY2xpZW50LCBidXQgdGhlIGFjdHVhbCBjb21wb25lbnQgaXMgcG9zaXRpb25lZCBwYXJ0aWFsbHkgb3V0c2lkZSB0aGUgYm9yZGVyXHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgdmFyIHBhcmVudCA9IHJlbmRlcmVyLnBhcmVudE5vZGUoZWxlbWVudCk7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgcmVuZGVyZXIuaW5zZXJ0QmVmb3JlKHBhcmVudCwgZmllbGRzZXQsIGVsZW1lbnQpO1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgIHJlbmRlcmVyLmFwcGVuZENoaWxkKGZpZWxkc2V0LCBsZWdlbmQpO1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgIHJlbmRlcmVyLmFwcGVuZENoaWxkKGZpZWxkc2V0LCBlbGVtZW50KTtcclxuXHJcbiAgICAgICAgICAgIHJlbmRlcmVyLmFwcGVuZENoaWxkKCBmaWVsZHNldCwgbGVnZW5kICk7XHJcbiAgICAgICAgICAgIGZvciAoIGNvbnN0IGkgaW4gZWxlbWVudC5jaGlsZE5vZGVzICkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCBlbGVtZW50LmNoaWxkTm9kZXNbaV0ubm9kZVR5cGUgPT09IDEgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVuZGVyZXIuYXBwZW5kQ2hpbGQoIGZpZWxkc2V0LCBlbGVtZW50LmNoaWxkTm9kZXNbaV0gKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZW5kZXJlci5hcHBlbmRDaGlsZCggZWxlbWVudCwgZmllbGRzZXQgKTtcclxuXHJcbiAgICAgICAgfSBlbHNlIGlmICggbmV3VmFsLmJvcmRlclN0eWxlICkge1xyXG4gICAgICAgICAgICByZW5kZXJlci5yZW1vdmVTdHlsZSggZWxlbWVudCwgJ2JvcmRlcicgKTtcclxuICAgICAgICAgICAgZm9yICggY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKG5ld1ZhbC5ib3JkZXJTdHlsZSkgKSB7XHJcbiAgICAgICAgICAgICAgICByZW5kZXJlci5zZXRTdHlsZSggZWxlbWVudCwga2V5LnJlcGxhY2UoIC8oW2Etel0pKFtBLVpdKS9nLCAnJDEtJDInICkudG9Mb3dlckNhc2UoKSwgbmV3VmFsLmJvcmRlclN0eWxlW2tleV0gKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIHNldEZvbnQoIGVsZW1lbnQ6IGFueSwgcmVuZGVyZXI6IFJlbmRlcmVyMiwgbmV3VmFsICkge1xyXG4gICAgICAgIGlmICggdHlwZW9mIG5ld1ZhbCAhPT0gJ29iamVjdCcgfHwgbmV3VmFsID09IG51bGwgKSB7XG4gcmVuZGVyZXIucmVtb3ZlU3R5bGUoIGVsZW1lbnQsICdmb250JyApOyByZXR1cm47XG59XHJcblxyXG4gICAgICAgIHJlbmRlcmVyLnJlbW92ZVN0eWxlKCBlbGVtZW50LCAnZm9udCcgKTtcclxuICAgICAgICBmb3IgKCBjb25zdCBrZXkgb2YgT2JqZWN0LmtleXMoIG5ld1ZhbCkgKSB7XHJcbiAgICAgICAgICAgIHJlbmRlcmVyLnNldFN0eWxlKCBlbGVtZW50LCBrZXkgLCBuZXdWYWxba2V5XSApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIHNldFZpc2libGUoIGVsZW1lbnQ6IGFueSwgcmVuZGVyZXI6IFJlbmRlcmVyMiwgbmV3VmFsICkge1xyXG4gICAgICAgIGxldCBjb3JyZWN0RWxlbWVudCA9IGVsZW1lbnQ7XHJcbiAgICAgICAgaWYgKHJlbmRlcmVyLnBhcmVudE5vZGUocmVuZGVyZXIucGFyZW50Tm9kZShlbGVtZW50KSkgPT09IGVsZW1lbnQuY2xvc2VzdCgnLnN2eS13cmFwcGVyJykpIHtcclxuICAgICAgICAgICAgY29ycmVjdEVsZW1lbnQgPSByZW5kZXJlci5wYXJlbnROb2RlKHJlbmRlcmVyLnBhcmVudE5vZGUoZWxlbWVudCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIG5ld1ZhbCA9PT0gdHJ1ZSApIHtcclxuICAgICAgICAgICAgLy8gY2FuIHdlIGltcHJvdmUgdGhpcyA/XHJcbiAgICAgICAgICAgIHJlbmRlcmVyLnJlbW92ZVN0eWxlKCBjb3JyZWN0RWxlbWVudCwgJ2Rpc3BsYXknICk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChuZXdWYWwgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgIHJlbmRlcmVyLnNldFN0eWxlKCBjb3JyZWN0RWxlbWVudCwgJ2Rpc3BsYXknICwgJ25vbmUnICk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgYWRkU2VsZWN0T25FbnRlciggZWxlbWVudDogYW55LCByZW5kZXJlcjogUmVuZGVyZXIyLCBkb2M6IERvY3VtZW50ICkge1xyXG4gICAgICAgIHJlbmRlcmVyLmxpc3RlbiggZWxlbWVudCwgJ2ZvY3VzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIHRoaXMgYWNjZXNzIFwiZG9jdW1lbnRcIiBkaXJlY3RseSB3aGljaCBzaG91ZG4ndCByZWFsbHkgYmUgZG9uZSwgYnV0IGFuZ3VsYXIgZG9lc24ndCBoYXZlIGVuY2Fwc3VsZWQgc3VwcG9ydCBmb3IgdGVzdGluZyBcImlzKFwiOmZvY3VzXCIpXCJcclxuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRGb2N1c2VkRWxlbWVudCA9IGRvYy5xdWVyeVNlbGVjdG9yKCAnOmZvY3VzJyApO1xyXG4gICAgICAgICAgICAgICAgaWYgKCBjdXJyZW50Rm9jdXNlZEVsZW1lbnQgPT09IGVsZW1lbnQgKVxyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc2VsZWN0KCk7XHJcbiAgICAgICAgICAgIH0sIDAgKTtcclxuICAgICAgICB9ICk7XHJcbiAgICB9XHJcbiAgICBwdWJsaWMgc3RhdGljIGdldFNjcm9sbGJhcnNTdHlsZU9iaihzY3JvbGxiYXJzOiBudW1iZXIpIHtcclxuICAgICAgIGNvbnN0IHN0eWxlID0ge307XHJcbiAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1iaXR3aXNlICovXHJcbiAgICAgICBpZiAoKHNjcm9sbGJhcnMgJiBzY3JvbGxiYXJDb25zdGFudHMuSE9SSVpPTlRBTF9TQ1JPTExCQVJfTkVWRVIpID09PSBzY3JvbGxiYXJDb25zdGFudHMuSE9SSVpPTlRBTF9TQ1JPTExCQVJfTkVWRVIpIHtcclxuICAgICAgICAgc3R5bGVbJ292ZXJmbG93WCddID0gJ2hpZGRlbic7XHJcbiAgICAgICB9IGVsc2UgaWYgKChzY3JvbGxiYXJzICYgc2Nyb2xsYmFyQ29uc3RhbnRzLkhPUklaT05UQUxfU0NST0xMQkFSX0FMV0FZUykgPT09IHNjcm9sbGJhckNvbnN0YW50cy5IT1JJWk9OVEFMX1NDUk9MTEJBUl9BTFdBWVMpIHtcclxuICAgICAgICAgc3R5bGVbJ292ZXJmbG93WCddID0gJ3Njcm9sbCc7XHJcbiAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICBzdHlsZVsnb3ZlcmZsb3dYJ10gPSAnYXV0byc7XHJcbiAgICAgICB9XHJcblxyXG4gICAgICAgaWYgKChzY3JvbGxiYXJzICYgc2Nyb2xsYmFyQ29uc3RhbnRzLlZFUlRJQ0FMX1NDUk9MTEJBUl9ORVZFUikgPT09IHNjcm9sbGJhckNvbnN0YW50cy5WRVJUSUNBTF9TQ1JPTExCQVJfTkVWRVIpIHtcclxuICAgICAgICAgc3R5bGVbJ292ZXJmbG93WSddID0gJ2hpZGRlbic7XHJcbiAgICAgICB9IGVsc2UgaWYgKChzY3JvbGxiYXJzICYgc2Nyb2xsYmFyQ29uc3RhbnRzLlZFUlRJQ0FMX1NDUk9MTEJBUl9BTFdBWVMpID09PSBzY3JvbGxiYXJDb25zdGFudHMuVkVSVElDQUxfU0NST0xMQkFSX0FMV0FZUykge1xyXG4gICAgICAgICBzdHlsZVsnb3ZlcmZsb3dZJ10gPSAnc2Nyb2xsJzsgLy8gJE5PTi1OTFMtMSRcclxuICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgIHN0eWxlWydvdmVyZmxvd1knXSA9ICdhdXRvJzsgLy8gJE5PTi1OTFMtMSRcclxuICAgICAgIH1cclxuICAgICAgIC8qIGVzbGludC1lbmFibGUgbm8tYml0d2lzZSAqL1xyXG4gICAgICAgcmV0dXJuIHN0eWxlO1xyXG4gICAgIH1cclxuXHJcbiAgICAgcHVibGljIHN0YXRpYyBzZXRTY3JvbGxiYXJzKGVsZW1lbnQ6IGFueSwgcmVuZGVyZXI6IFJlbmRlcmVyMiwgdmFsdWUpIHtcclxuICAgICAgIGNvbnN0IHN0eWxlID0gdGhpcy5nZXRTY3JvbGxiYXJzU3R5bGVPYmoodmFsdWUpO1xyXG4gICAgICAgT2JqZWN0LmtleXMoc3R5bGUpLmZvckVhY2goa2V5ID0+IHtcclxuICAgICAgICByZW5kZXJlci5zZXRTdHlsZShlbGVtZW50LCBrZXksIHN0eWxlW2tleV0pO1xyXG4gICAgICAgfSk7XHJcbiAgICAgfVxyXG4gICAgIC8vIGludGVybmFsIGZ1bmN0aW9uXHJcbiAgICAgcHVibGljIHN0YXRpYyBnZXRQcm9wQnlTdHJpbmdQYXRoKG8sIHMpIHtcclxuICAgICAgIHMgPSBzLnJlcGxhY2UoL1xcWyhcXHcrKVxcXS9nLCAnLiQxJyk7IC8vIGNvbnZlcnQgaW5kZXhlcyB0byBwcm9wZXJ0aWVzXHJcbiAgICAgICBzID0gcy5yZXBsYWNlKC9eXFwuLywgJycpOyAgICAgICAgICAgLy8gc3RyaXAgYSBsZWFkaW5nIGRvdFxyXG4gICAgICAgY29uc3QgYSA9IHMuc3BsaXQoJy4nKTtcclxuICAgICAgIHdoaWxlIChhLmxlbmd0aCkge1xyXG4gICAgICAgICBjb25zdCBuID0gYS5zaGlmdCgpO1xyXG4gICAgICAgICBpZiAobiBpbiBvKSB7XHJcbiAgICAgICAgICAgbyA9IG9bbl07XHJcbiAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIHJldHVybiBvO1xyXG4gICAgICAgfVxyXG4gICAgIH1cclxufVxyXG4iXX0=